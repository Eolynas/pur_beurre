{% extends 'products/base.html' %}
{% block title %} Resultat {% endblock %}
{% load static %}
{% block content %}
    <header class="masthead header_result sidebar">
        {% if initial_product.image_product %}
            <img class="img_header" src="{{ initial_product.image_product }}">
        {% endif %}

        <div class="container h-100">
            <div class="row h-100 align-items-center justify-content-center text-center">

                <div class="col-lg-10">
                    <h1 class="text-uppercase text-white font-weight-bold">
                        {% if initial_product %}
                            {{ initial_product.name }}
                        {% else %}
                            Aucun produit trouvé
                        {% endif %}
                    </h1>
                    <hr class="divider my-4"/>
                </div>
            </div>
        </div>
    </header>

    {% if initial_product %}
        <div class="row align-items-center justify-content-center text-center mt-4">
            <div class="col-lg-10">
                <h4 class="font-weight-bold"> Vous pouvez remplacer cet aliment par:</h4>
                <hr class="divider my-4"/>
            </div>
        </div>
        {% if not user.is_authenticated %}
            <div class="info_auth">
                <h4>Penser à vous enregistrer ou vous authentifier pour sauvegarder les produits</h4>
            </div>
        {% endif %}
        {#    TODO Ancienne affichage#}
        <div class="container">
            <div class="row row-cols-3 products">
                {% for product in substitut_products %}
                    <div class="product">
                        <a class="container_img_product" href="{% url "products" id_product=product.id %}">
                            <img class="img_product" src="{{ product.image_product }}">

                            <span class="nutri_grade nutri_grade_color_{{ product.nutriscore }}">
                                <img class=""
                                     src="../../static/product/img/nutriscore/nutriscore_grade_{{ product.nutriscore }}.png"
                                     alt=""/>
                            </span>
                        </a>
                        <a href="{% url "products" id_product=product.id %}">{{ product.name }}</a>
                        <div class="save_product">

                            {% if user.is_authenticated %}

                                {% if product in product_save_for_user %}
                                    <p class="button_save_product_true">
                                        <i class="fa fa-save" aria-hidden="true"></i>
                                        Deja sauvegardé
                                    </p>
                                {% else %}
                                    <form action="{% url "product_save" %}" method="post">
                                        {% csrf_token %}
                                        <div>
                                            <input type="hidden" id="product_id" name="product_id" value="{{ product.id }}">
                                        </div>
                                        <div>
                                            <button type="submit">
                                                <i class="fa fa-save" aria-hidden="true"></i>
                                                Sauvegarder {{ product.id }}
                                            </button>
                                        </div>
                                        <input type="hidden" id="postId" name="postId" value="34657">
                                    </form>
{#                                    <button type="button" id="submit_save_product{{ product.id }}"#}
{#                                            data-button="{{ product.id }}">#}
{#                                        <i class="fa fa-save" aria-hidden="true"></i>#}
{#                                        <a href="{% url "product_save" id_product=product.id %}">Sauvegarder</a>#}
{#                                    </button>#}
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>

                {% endfor %}
            </div>
        </div>


    {% endif %}

{% endblock %}